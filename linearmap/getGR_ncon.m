function GR = getGR_ncon(AR, G, N, D)
    GR = zeros(D);
    ARc = conj(AR);
    if N == 1
        GR = ncon({G,AR,ARc},{[2 3],[-4 2 1],[-5 3 1]},[1 2 3],[-4 -5]);
    elseif N == 2
        GR = ncon({G,AR,AR,ARc,ARc},{[6 2 7 3],[-8 6 4],[4 2 1],[-9 7 5],[5 3 1]},[1 2 3 4 5 6 7],[-8 -9]);
    elseif N == 3
        GR = ncon({G,AR,AR,AR,ARc,ARc,ARc},{[10 6 2 11 7 3],[-12 10 8],[8 6 4],[4 2 1],[-13 11 9],[9 7 5],[5 3 1]},[1 2 3 4 5 6 7 8 9 10 11],[-12 -13]);
    elseif N == 4
        GR = ncon({G,AR,AR,AR,AR,ARc,ARc,ARc,ARc},{[14 10 6 2 15 11 7 3],[-16 14 12],[12 10 8],[8 6 4],[4 2 1],[-17 15 13],[13 11 9],[9 7 5],[5 3 1]},[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15],[-16 -17]);
    end
end
