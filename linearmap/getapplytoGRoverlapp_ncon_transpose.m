function y = getapplytoGRoverlapp_ncon_transpose(AR, G, L, N, d, p, g, yg)
    if N == 1
        y = zeros(d,d);
    elseif N == 2
        ARc = conj(AR);
        y = ncon({G,L,AR,AR,AR,ARc,ARc,ARc},{[11 -7 12 8],[13 14],[14 11 10],[10 -6 5],[5 -2 1],[13 12 9],[9 8 4],[4 -3 1]},[14 13 12 11 10 9 8 5 4 1],[-7 -3 -6 -2]);
        y = y - g*yg;
        y = exp(1i*p)*y;
    elseif N == 3
        ARc = conj(AR);
        y = exp(1i*p)*ncon({G,L,AR,AR,AR,AR,ARc,ARc,ARc,ARc},{[16 -12 -7 17 13 8],[18 19],[19 16 15],[15 -11 9],[9 -6 5],[5 -2 1],[18 17 14],[14 13 10],[10 8 4],[4 -3 1]},[19 18 17 16 15 14 13 10 9 8 5 4 1],[-12 -7 -3 -11 -6 -2]);
        y = y - (exp(1i*p)*g)*yg;
        y = y + exp(2*1i*p)*ncon({G,L,AR,AR,AR,AR,AR,ARc,ARc,ARc,ARc,ARc},{[20 16 -10 19 15 9],[21 22],[22 20 17],[17 16 13],[13 -11 12],[12 -6 5],[5 -2 1],[21 19 18],[18 15 14],[14 9 8],[8 -7 4],[4 -3 1]},[22 21 20 19 18 17 16 15 14 13 12 9 8 5 4 1],[-10 -7 -3 -11 -6 -2]);
        y = y - (exp(2*1i*p)*g)*yg;
    elseif N == 4
        ARc = conj(AR);
        y = exp(1i*p)*ncon({G,L,AR,AR,AR,AR,AR,ARc,ARc,ARc,ARc,ARc},{[21 -17 -12 -7 22 18 13 8],[23 24],[24 21 20],[20 -16 15],[15 -11 10],[10 -6 4],[4 -2 1],[23 22 19],[19 18 14],[14 13 9],[9 8 5],[5 -3 1]},[24 23 22 21 20 19 18 15 14 13 10 9 8 5 4 1],[-17 -12 -7 -3 -16 -11 -6 -2]);
        y = y - (exp(1i*p)*g)*yg;
        y = y + exp(2*1i*p)*ncon({G,L,AR,AR,AR,AR,AR,AR,ARc,ARc,ARc,ARc,ARc,ARc},{[24 20 -16 -11 25 21 17 12],[26 27],[27 24 23],[23 20 19],[19 -15 14],[14 -10 9],[9 -6 4],[4 -2 1],[26 25 22],[22 21 18],[18 17 13],[13 12 8],[8 -7 5],[5 -3 1]},[27 26 25 24 23 22 21 20 19 18 17 14 13 12 9 8 5 4 1],[-16 -11 -7 -3 -15 -10 -6 -2]);
        y = y - (exp(2*1i*p)*g)*yg;
        y = y + exp(3*1i*p)*ncon({G,L,AR,AR,AR,AR,AR,AR,AR,ARc,ARc,ARc,ARc,ARc,ARc,ARc},{[27 23 19 -15 28 24 20 16],[29 30],[30 27 26],[26 23 22],[22 19 18],[18 -14 13],[13 -10 9],[9 -6 4],[4 -2 1],[29 28 25],[25 24 21],[21 20 17],[17 16 12],[12 -11 8],[8 -7 5],[5 -3 1]},[30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 13 12 9 8 5 4 1],[-15 -11 -7 -3 -14 -10 -6 -2]);
        y = y - (exp(3*1i*p)*g)*yg;
    end    
end
