function y = getapplytoGoverlap_ncon_transpose(AL, G, R, N, g, yg)
    ALc = conj(AL);
    if N == 1
        y = ncon({G,R,AL,ALc},{[-2 1],[4 5],[6 -3 4],[6 1 5]},[6 5 4 1],[-2 -3]);
        y = y - g*yg;
    elseif N == 2
        y = ncon({G,R,AL,AL,ALc,ALc},{[-3 -4 1 2],[7 8],[11 -5 10],[10 -6 7],[11 1 9],[9 2 8]},[11 10 9 8 7 2 1],[-3 -4 -5 -6]);
        y = y - g*yg;
    elseif N == 3
        y = ncon({G,R,AL,AL,AL,ALc,ALc,ALc},{[-4 -5 -6 1 2 3],[10 11],[16 -7 14],[14 -8 12],[12 -9 10],[16 1 15],[15 2 13],[13 3 11]},[10 11 3 12 13 2 14 15 1 16],[-4 -5 -6 -7 -8 -9]);
        y = y - g*yg;
    elseif N == 4
        y = ncon({G,R,AL,AL,AL,AL,ALc,ALc,ALc,ALc},{[-5 -6 -7 -8 1 2 3 4],[20 21],[9 -10 11],[11 -13 14],[14 -16 17],[17 -19 20],[9 1 12],[12 2 15],[15 3 18],[18 4 21]},[9 11 1 12 2 14 15 3 18 17 4 21 20],[-5 -6 -7 -8 -10 -13 -16 -19]);
        y = y - g*yg;
    end
end
